(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7609],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return d},kt:function(){return m}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),l=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=l(e.components);return r.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=l(t),m=a,g=u["".concat(p,".").concat(m)]||u[m]||c[m]||o;return t?r.createElement(g,i(i({ref:n},d),{},{components:t})):r.createElement(g,i({ref:n},d))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5882:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return i},metadata:function(){return s},toc:function(){return p},default:function(){return d}});var r=t(2122),a=t(9756),o=(t(7294),t(3905)),i={id:"contributing_segment",title:"Add Segment",sidebar_label:"Add Segment"},s={unversionedId:"contributing_segment",id:"contributing_segment",isDocsHomePage:!1,title:"Add Segment",description:"Create the logic",source:"@site/docs/contributing-segment.md",sourceDirName:".",slug:"/contributing_segment",permalink:"/docs/contributing_segment",editUrl:"https://github.com/jandedobbeleer/oh-my-posh/edit/main/docs/docs/contributing-segment.md",version:"current",sidebar_label:"Add Segment",frontMatter:{id:"contributing_segment",title:"Add Segment",sidebar_label:"Add Segment"},sidebar:"docs",previous:{title:"Get Started",permalink:"/docs/contributing_started"},next:{title:"Git commands for contributors",permalink:"/docs/contributing_git"}},p=[{value:"Create the logic",id:"create-the-logic",children:[]},{value:"Create a name for your Segment",id:"create-a-name-for-your-segment",children:[]},{value:"Add the SegmentType mapping",id:"add-the-segmenttype-mapping",children:[]},{value:"Test your functionality",id:"test-your-functionality",children:[]},{value:"Add the documentation",id:"add-the-documentation",children:[]},{value:"Map the new documentation in the sidebar",id:"map-the-new-documentation-in-the-sidebar",children:[]},{value:"Add the JSON schema",id:"add-the-json-schema",children:[]},{value:"Create a pull request",id:"create-a-pull-request",children:[]}],l={toc:p};function d(e){var n=e.components,t=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"create-the-logic"},"Create the logic"),(0,o.kt)("p",null,"Add a new file following this convention: ",(0,o.kt)("inlineCode",{parentName:"p"},"new_segment.go"),".\nEnsure ",(0,o.kt)("inlineCode",{parentName:"p"},"new")," is a single verb indicating the context the segment renders."),(0,o.kt)("p",null,"You can use the following template as a guide."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\ntype new struct {\n    props          *properties\n    env            environmentInfo\n}\n\nconst (\n    //NewProp switches something\n    NewProp Property = "newprop"\n)\n\nfunc (n *new) enabled() bool {\n    true\n}\n\nfunc (n *new) string() string {\n    newText := n.props.getString(NewProp, "\\uEFF1")\n    return newText\n}\n\nfunc (n *new) init(props *properties, env environmentInfo) {\n    n.props = props\n    n.env = env\n}\n')),(0,o.kt)("p",null,'When it comes to properties, make sure to use the UTF32 representation (e.g. "\\uEFF1") rather than the icon itself.\nThis will facilitate the review process as not all environments display the icons based on the font being used.\nYou can find these values and query for icons easily at ',(0,o.kt)("a",{parentName:"p",href:"https://www.nerdfonts.com/cheat-sheet"},"Nerd Fonts"),"."),(0,o.kt)("p",null,"For each segment, there's a single test file ensuring the functionality going forward. The convention\nis ",(0,o.kt)("inlineCode",{parentName:"p"},"new_segment_test.go"),", have a look at existing segment tests for inspiration."),(0,o.kt)("h2",{id:"create-a-name-for-your-segment"},"Create a name for your Segment"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/JanDeDobbeleer/oh-my-posh/blob/main/segment.go"},(0,o.kt)("inlineCode",{parentName:"a"},"segment.go"))," contains the list of available ",(0,o.kt)("inlineCode",{parentName:"p"},"SegmentType"),"'s, which gives them a name we can map from the\n",(0,o.kt)("inlineCode",{parentName:"p"},".json")," ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/JanDeDobbeleer/oh-my-posh/tree/main/themes"},"themes"),"."),(0,o.kt)("p",null,"Add your segment."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'//New is brand new\nNew SegmentType = "new"\n')),(0,o.kt)("h2",{id:"add-the-segmenttype-mapping"},"Add the SegmentType mapping"),(0,o.kt)("p",null,"Map your ",(0,o.kt)("inlineCode",{parentName:"p"},"SegmentType")," to your Segment in the ",(0,o.kt)("inlineCode",{parentName:"p"},"mapSegmentWithWriter")," function."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"New: &new{},\n")),(0,o.kt)("h2",{id:"test-your-functionality"},"Test your functionality"),(0,o.kt)("p",null,"Even with unit tests, it's a good idea to build and validate the changes:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"go build -o $GOPATH/bin/oh-my-posh\n")),(0,o.kt)("h2",{id:"add-the-documentation"},"Add the documentation"),(0,o.kt)("p",null,"Create a new ",(0,o.kt)("inlineCode",{parentName:"p"},"markdown")," file underneath the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/JanDeDobbeleer/oh-my-posh/tree/main/docs/docs"},(0,o.kt)("inlineCode",{parentName:"a"},"docs/docs"))," folder called ",(0,o.kt)("inlineCode",{parentName:"p"},"segment-new.md"),".\nUse the following template as a guide."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-markdown"},'---\nid: new\ntitle: New\nsidebar_label: New\n---\n\n## What\n\nDisplay something new.\n\n## Sample Configuration\n\n```json\n{\n  "type": "new",\n  "style": "powerline",\n  "powerline_symbol": "\\uE0B0",\n  "foreground": "#193549",\n  "background": "#ffeb3b",\n  "properties": {\n    "newprop": "\\uEFF1"\n  }\n}\n```\n\n## Properties\n\n- newprop: `string` - the new text to show - defaults to `\\uEFF1`\n')),(0,o.kt)("h2",{id:"map-the-new-documentation-in-the-sidebar"},"Map the new documentation in the sidebar"),(0,o.kt)("p",null,"Open ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/JanDeDobbeleer/oh-my-posh/blob/main/docs/sidebars.js"},(0,o.kt)("inlineCode",{parentName:"a"},"sidebars.js"))," and add your document id (",(0,o.kt)("inlineCode",{parentName:"p"},"new"),") to the items of the Segments category."),(0,o.kt)("h2",{id:"add-the-json-schema"},"Add the JSON schema"),(0,o.kt)("p",null,"Edit the ",(0,o.kt)("inlineCode",{parentName:"p"},"themes/schema.json")," file to add your segment."),(0,o.kt)("p",null,"At ",(0,o.kt)("inlineCode",{parentName:"p"},"$.definitions.segment.properties.type.enum"),", add your ",(0,o.kt)("inlineCode",{parentName:"p"},"SegmentType")," to the array:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"new,\n")),(0,o.kt)("p",null,"At ",(0,o.kt)("inlineCode",{parentName:"p"},"$.definitions.segment.allOf"),", add your segment details:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "if": {\n    "properties": {\n      "type": { "const": "new" }\n    }\n  },\n  "then": {\n    "title": "Display something new",\n    "description": "https://ohmyposh.dev/docs/new",\n    "properties": {\n      "properties": {\n        "properties": {\n          "nwprop": {\n            "type": "string",\n            "title": "New Prop",\n            "description": "the new text to show",\n            "default": "\\uEFF1"\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,o.kt)("h2",{id:"create-a-pull-request"},"Create a pull request"),(0,o.kt)("p",null,"And be patient, I'm going as fast as I can \ud83c\udfce"))}d.isMDXComponent=!0}}]);